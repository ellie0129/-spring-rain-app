# spring_rain_app.py (ìµœì¢… ì™„ì„±ë³¸)
# ë¶„ì„ê¸° Tabê³¼ ëª¨í˜• ì„¤ëª… Tab ì™„ì „ ë¶„ë¦¬, ì „ì²´ ì½”ë“œ êµ¬ì„±

import streamlit as st
import numpy as np
import plotly.graph_objects as go
from typing import Dict

st.set_page_config(page_title="ë´„ë¹„ ì ìˆ˜ ë¶„ì„ê¸°", page_icon="ğŸŒ±", layout="wide")

st.title("ğŸŒ§ï¸ ë´„ë¹„(Spring Rain) ì ìˆ˜ ë¶„ì„ê¸°")
st.caption("ì„œìš¸ì‹œë¦½ëŒ€í•™êµ | ì´ì¶˜ìš° êµìˆ˜ë‹˜ì˜ ê¸°ì—…ê°€ì •ì‹  í†µí•©ëª¨í˜• ê¸°ë°˜")

menu = st.sidebar.radio("ë©”ë‰´", ["ë¶„ì„ê¸°", "ëª¨í˜• ì„¤ëª…"])

if menu == "ëª¨í˜• ì„¤ëª…":
    st.header("ğŸ“˜ ê¸°ì—…ê°€ì •ì‹  í†µí•©ëª¨í˜• êµ¬ì¡° ì„¤ëª…")
    st.markdown("""
    ### ğŸŒŸ Outcome Layer (2ê°€ì§€)
    - ë¶€ì˜ ì¦ëŒ€ (Wealth Creation)
    - ê°€ì¹˜ ì°½ì¶œ (Value Creation)

    ### ğŸ¯ Mission Layer (4ê°€ì§€)
    - ê¸°íšŒì¶”êµ¬ (Opportunity Seeking)
    - ê³µë™ì²´ ë°œì „ (Community Development)
    - ì°½ì¡°ì  íŒŒê´´ (Creative Destruction)
    - ë¯¸ë˜ì§€í–¥ (Future Orientation)

    ### ğŸŒ€ Attitude Layer (8ê°€ì§€)
    - ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ
    - ì¡°í•© Â· ì¤‘ê°œ
    - í˜ì‹  Â· ë³€í™” Â· ê°œì„ 
    - ë„ì „ Â· ê·¹ë³µ
    - ì£¼ë„ Â· ì‚¬ì—…í™”
    - ì—­ë°œìƒ Â· ì¬í•´ì„
    - ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜
    - ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ

    ### ğŸ§¬ Competence Layer (8ê°€ì§€)
    - ğŸ’ª ë„ì „ì •ì‹ : ìê¸°íš¨ëŠ¥ê° (self-efficacy), ìì‹ ê° (self confidence), ì„±ì·¨ ìš•êµ¬ (N-Achievement), í—ê·¸ë¦¬ì •ì‹ , ëª©í‘œ ë‹¬ì„± ì¶”êµ¬
    - ğŸ’¡ ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥: ì—´ë§(ì•¼ë§), ì¶”ì§„ë ¥, ì‹¤í–‰ë ¥, ê²°ë‹¨ë ¥(ì˜ì‚¬ê²°ì •), ê³ ìˆ˜ìµ ê¸°ëŒ€
    - ğŸ§­ Integrity: ë¦¬ë”ì‹­, ì‚¬ì—…ìˆ˜ì™„, ê²½ì˜ ê´€ë¦¬ ì—­ëŸ‰, ì‹ ìš©, ì‹ ë¢°, ê·¼ë©´, ê²€ì†Œ, ì„±ì‹¤ì„±
    - ğŸ” ì°½ì¡°ì  ë¬¸ì œí•´ê²°: ê¸ì •ì , ë‚™ê´€ì , í†µì°°ë ¥, ì•ˆëª©, ì•„ì´ë””ì–´, ìƒìƒë ¥, í˜¸ê¸°ì‹¬, íƒêµ¬, ì¸ì§€ ëŠ¥ë ¥ (ì§€ì  ëŠ¥ë ¥)
    - ğŸŒ± ë…ë¦½ì„±Â·ìê¸°ê³ ìš©: ìì•„ì‹¤í˜„ (self actualization), ììœ¨ì„± ì§€í–¥, ìˆœì‘ ê±°ë¶€, ì—­ê²½ ê·¹ë³µ
    - ğŸš€ ì§„ì·¨ì„±(ì„ ë„ì„±): ì—´ì •, ë†’ì€ ëª¨í˜¸ì„± ì¸ë‚´ë„, ê²½ìŸì  ê³µê²©ì„±, ì„ ë„ì 
    - ğŸ›¡ ìœ„í—˜ê°ìˆ˜ì„±: ì¸ë‚´ì‹¬, ìœ„í—˜ì„ í˜¸, CSR/CSV, ì±…ì„ê°(ì±…ì„ì˜ì‹)
    - ğŸ”„ í˜ì‹ ì„±: ê¸°ì—…ìœ¤ë¦¬, ì°½ì˜ì„±, ë³€í™” ë° í˜ì‹  ì ê·¹ ìˆ˜ìš©

    ---

    ### ğŸ’¡ ì ìˆ˜ ì „ì´ êµ¬ì¡° ìš”ì•½
    ê° ë ˆì´ì–´ëŠ” í•˜ìœ„ ë ˆë²¨ì˜ ì ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒìœ„ ë ˆë²¨ ì ìˆ˜ë¥¼ ì‚°ì¶œí•©ë‹ˆë‹¤:

    - **Competence â†’ Attitude**: í•˜ë‚˜ì˜ ì—­ëŸ‰ ë²ˆë“¤ì´ ë‘ ê°œì˜ íƒœë„ í•­ëª©ì— ê°ê° 0.5ì˜ ê°€ì¤‘ì¹˜ë¡œ ë¶„ë°°ë©ë‹ˆë‹¤.
    - **Attitude â†’ Mission**: ê° íƒœë„ í•­ëª©ì€ ë¯¸ì…˜ í•­ëª©ì— ì‚¬ì „ì— ì •ì˜ëœ ê°€ì¤‘ì¹˜ ë¹„ìœ¨(0.25 ë˜ëŠ” 0.5)ë¡œ ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.
    - **Mission â†’ Outcome**: 4ê°œ ë¯¸ì…˜ í•­ëª©ì˜ í‰ê· ê°’ì´ Outcome ì ìˆ˜ë¡œ í™˜ì‚°ë©ë‹ˆë‹¤.

    â†’ ì „ì²´ì ìœ¼ë¡œëŠ” ê³„ì¸µ ê°„ ìœ ê¸°ì ì¸ íë¦„ì„ í†µí•´ 'í–‰ë™'ì—ì„œ 'ì˜ë¯¸'ë¡œ, ë‹¤ì‹œ 'ì„±ê³¼'ë¡œ ì´í–‰ë˜ëŠ” êµ¬ì¡°ë¥¼ ìˆ˜ì¹˜í™”í•©ë‹ˆë‹¤.

    ---

    ### ğŸ–¼ï¸ í†µí•©ëª¨í˜• ì‹œê° ìë£Œ
    ![í†µí•©ëª¨í˜• ì´ë¯¸ì§€](https://raw.githubusercontent.com/ellie0129/spring-rain-app/main/assets/1ce34f642e1b80808f4edd8cc64b1a95.png)
    """)

trait_names = {
    "ë„ì „ì •ì‹ ": ["ìê¸°íš¨ëŠ¥ê° (self-efficacy), ìì‹ ê° (self confidence)", "ì„±ì·¨ ìš•êµ¬ (N-Achievement)", "í—ê·¸ë¦¬ì •ì‹ , ëª©í‘œ ë‹¬ì„± ì¶”êµ¬"],
    "ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥": ["ì—´ë§(ì•¼ë§)", "ì¶”ì§„ë ¥, ì‹¤í–‰ë ¥", "ê²°ë‹¨ë ¥(ì˜ì‚¬ê²°ì •)", "ê³ ìˆ˜ìµ ê¸°ëŒ€"],
    "Integrity": ["ë¦¬ë”ì‹­", "ì‚¬ì—…ìˆ˜ì™„", "ê²½ì˜ ê´€ë¦¬ ì—­ëŸ‰", "ì‹ ìš©, ì‹ ë¢°", "ê·¼ë©´, ê²€ì†Œ, ì„±ì‹¤ì„±"],
    "ì°½ì¡°ì  ë¬¸ì œí•´ê²°": ["ê¸ì •ì , ë‚™ê´€ì ", "í†µì°°ë ¥, ì•ˆëª©", "ì•„ì´ë””ì–´, ìƒìƒë ¥, í˜¸ê¸°ì‹¬, íƒêµ¬", "ì¸ì§€ ëŠ¥ë ¥ (ì§€ì  ëŠ¥ë ¥)"],
    "ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„": ["ìì•„ì‹¤í˜„ (self actualization)", "ììœ¨ì„± ì§€í–¥", "ìˆœì‘ ê±°ë¶€", "ì—­ê²½ ê·¹ë³µ"],
    "ì§„ì·¨ì„±(ì„ ë„ì„±)": ["ì—´ì •", "ë†’ì€ ëª¨í˜¸ì„± ì¸ë‚´ë„", "ê²½ìŸì  ê³µê²©ì„±", "ì„ ë„ì "],
    "ìœ„í—˜ê°ìˆ˜ì„±": ["ì¸ë‚´ì‹¬", "ìœ„í—˜ì„ í˜¸", "CSR/CSV", "ì±…ì„ê°(ì±…ì„ì˜ì‹)"],
    "í˜ì‹ ì„±": ["ê¸°ì—…ìœ¤ë¦¬", "ì°½ì˜ì„±", "ë³€í™” ë° í˜ì‹  ì ê·¹ ìˆ˜ìš©"]
}

if menu == "ë¶„ì„ê¸°":
    st.subheader("ğŸ›ï¸ ì§ì ‘ ì¡°ì‘: ë‚˜ë§Œì˜ ì ìˆ˜ ë§Œë“¤ê¸°")
    custom_scores = {}
    with st.expander("ğŸ§¬ ê° í•˜ìœ„ ìš”ì†Œë³„ë¡œ ì ìˆ˜ë¥¼ ì§ì ‘ ì„¤ì •í•´ë³´ì„¸ìš” (0.0 ~ 1.0)"):
        for bundle, traits in trait_names.items():
            scores = []
            st.markdown(f"**{bundle}**")
            for trait in traits:
                val = st.slider(f"{trait}", 0.0, 1.0, 0.0, 0.01, key=f"{bundle}-{trait}")
                scores.append(val)
            if scores:
                custom_scores[bundle] = np.mean(scores)

    if not selected_name and custom_scores:
        competence_scores = custom_scores
        st.success("ğŸ§ª ì§ì ‘ ì„¤ì •í•œ ì ìˆ˜ë¡œ ë¶„ì„ì„ ì§„í–‰í•©ë‹ˆë‹¤!")
    st.subheader("ğŸ¤– AI ê¸°ë°˜ ì¸ë¬¼ ë¶„ì„")
    st.caption("ì˜ˆì‹œ: ì œí”„ ë² ì¡°ìŠ¤, ê¹€ìŠ¬ì•„, ì •ì£¼ì˜")

    selected_name = st.text_input("ë¶„ì„í•  ì¸ë¬¼ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”")

    sample_profiles = {
        "ì œí”„ ë² ì¡°ìŠ¤": ([
            ("ë„ì „ì •ì‹ ", [1.0, 0.9, 0.9]),
            ("ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥", [0.9, 0.9, 0.95, 0.9]),
            ("Integrity", [0.85, 0.85, 0.9, 0.85, 0.9]),
            ("ì°½ì¡°ì  ë¬¸ì œí•´ê²°", [0.95, 0.9, 0.9, 0.9]),
            ("ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„", [0.9, 0.9, 0.85, 0.9]),
            ("ì§„ì·¨ì„±(ì„ ë„ì„±)", [0.95, 0.95, 0.9, 0.95]),
            ("ìœ„í—˜ê°ìˆ˜ì„±", [0.9, 0.9, 0.9, 0.95]),
            ("í˜ì‹ ì„±", [0.95, 0.95, 0.95])
        ], "ì•„ë§ˆì¡´ ì°½ë¦½ì ì œí”„ ë² ì¡°ìŠ¤ëŠ” í˜ì‹ ì„±ê³¼ ì§„ì·¨ì„± ë©´ì—ì„œ íƒ€ì˜ ì¶”ì¢…ì„ ë¶ˆí—ˆí•˜ë©°, ë¬¸ì œ í•´ê²°ë ¥ê³¼ ì¶”ì§„ë ¥, ë„ì „ì •ì‹ ì—ì„œ ë§¤ìš° ë†’ì€ ì—­ëŸ‰ì„ ë³´ì…ë‹ˆë‹¤."),

        "ê¹€ìŠ¬ì•„": ([
            ("ë„ì „ì •ì‹ ", [0.9, 0.85, 0.85]),
            ("ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥", [0.85, 0.85, 0.9, 0.85]),
            ("Integrity", [0.85, 0.85, 0.85, 0.85, 0.85]),
            ("ì°½ì¡°ì  ë¬¸ì œí•´ê²°", [0.9, 0.9, 0.85, 0.9]),
            ("ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„", [0.85, 0.85, 0.8, 0.85]),
            ("ì§„ì·¨ì„±(ì„ ë„ì„±)", [0.9, 0.9, 0.9, 0.9]),
            ("ìœ„í—˜ê°ìˆ˜ì„±", [0.8, 0.8, 0.8, 0.9]),
            ("í˜ì‹ ì„±", [0.9, 0.9, 0.95])
        ], "ë§ˆì¼“ì»¬ë¦¬ë¥¼ ì°½ì—…í•œ ê¹€ìŠ¬ì•„ ëŒ€í‘œëŠ” ê³ ìœ„í—˜ì„ ê°ìˆ˜í•˜ë©° ìƒˆë¡œìš´ ë¬¼ë¥˜ íŒ¨ëŸ¬ë‹¤ì„ì„ ì œì‹œí–ˆê³ , ì‹¤í–‰ë ¥ê³¼ í˜ì‹  ìˆ˜ìš©ì„±ì—ì„œ ë‘ê°ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤."),

        "ì •ì£¼ì˜": ([
            ("ë„ì „ì •ì‹ ", [1.0, 0.95, 0.95]),
            ("ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥", [0.95, 0.95, 0.9, 0.95]),
            ("Integrity", [0.9, 0.9, 0.9, 0.95, 0.95]),
            ("ì°½ì¡°ì  ë¬¸ì œí•´ê²°", [0.9, 0.9, 0.9, 0.9]),
            ("ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„", [0.95, 0.9, 0.95, 0.9]),
            ("ì§„ì·¨ì„±(ì„ ë„ì„±)", [0.95, 0.95, 0.95, 0.95]),
            ("ìœ„í—˜ê°ìˆ˜ì„±", [0.9, 0.9, 0.95, 0.95]),
            ("í˜ì‹ ì„±", [0.9, 0.95, 0.95])
        ], "í˜„ëŒ€ê·¸ë£¹ì„ ì¼êµ° ì •ì£¼ì˜ íšŒì¥ì€ ììœ¨ì„±, ë„ì „ì •ì‹ , ì‹¤í–‰ë ¥ ë“± ì „ë°©ìœ„ì  ì—­ëŸ‰ì—ì„œ ê³ ë£¨ ë›°ì–´ë‚œ ì¸ë¬¼ì…ë‹ˆë‹¤.")
    }

    competence_scores = {}
    if selected_name == "ì´ì¶˜ìš°":
        st.success("ğŸŒŸ ë‹¹ì‹ ì€ ì´ë¯¸ ì™„ì„±ëœ í†µí•©ëª¨í˜• ê·¸ ìì²´ë¥¼ ì…ë ¥í•˜ì…¨ìŠµë‹ˆë‹¤!")
        competence_scores = {k: 1.0 for k in trait_names.keys()}

    elif selected_name in sample_profiles:
        traits, comment = sample_profiles[selected_name]
        for bundle, values in traits:
            competence_scores[bundle] = np.mean(values)

        st.success(f"âœ… '{selected_name}'ì˜ ì—­ëŸ‰ í”„ë¡œíŒŒì¼ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤")
        st.markdown(f"ğŸ’¬ **AI í‰ê°€ ì£¼ì„**: {comment}")

        # ì»´í“¨íŒ… í•¨ìˆ˜ ì •ì˜ê°€ ì˜ëª»ëœ ë“¤ì—¬ì“°ê¸°ë¡œ ì¸í•œ ì˜¤ë¥˜ í•´ê²°
        def compute_bombi_score(competence_scores):
            comp_to_att = {
                "ë„ì „ì •ì‹ ": ["ë„ì „ Â· ê·¹ë³µ", "ì£¼ë„ Â· ì‚¬ì—…í™”"],
                "ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥": ["ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ", "í˜ì‹  Â· ë³€í™” Â· ê°œì„ "],
                "Integrity": ["ì¡°í•© Â· ì¤‘ê°œ", "ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ"],
                "ì°½ì¡°ì  ë¬¸ì œí•´ê²°": ["ì—­ë°œìƒ Â· ì¬í•´ì„", "ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜"],
                "ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„": ["ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ", "ë„ì „ Â· ê·¹ë³µ"],
                "ì§„ì·¨ì„±(ì„ ë„ì„±)": ["ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜", "ì£¼ë„ Â· ì‚¬ì—…í™”"],
                "ìœ„í—˜ê°ìˆ˜ì„±": ["ì¡°í•© Â· ì¤‘ê°œ", "í˜ì‹  Â· ë³€í™” Â· ê°œì„ "],
                "í˜ì‹ ì„±": ["ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ", "ì—­ë°œìƒ Â· ì¬í•´ì„"]
            }

            att_to_mission = {
                "ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ": ["ë¯¸ë˜ì§€í–¥"],
                "ì¡°í•© Â· ì¤‘ê°œ": ["ê¸°íšŒì¶”êµ¬"],
                "í˜ì‹  Â· ë³€í™” Â· ê°œì„ ": ["ì°½ì¡°ì  íŒŒê´´"],
                "ë„ì „ Â· ê·¹ë³µ": ["ê¸°íšŒì¶”êµ¬"],
                "ì£¼ë„ Â· ì‚¬ì—…í™”": ["ê¸°íšŒì¶”êµ¬"],
                "ì—­ë°œìƒ Â· ì¬í•´ì„": ["ì°½ì¡°ì  íŒŒê´´"],
                "ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜": ["ë¯¸ë˜ì§€í–¥"],
                "ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ": ["ê³µë™ì²´ ë°œì „"]
            }

            mission_to_outcome = {
                "ê¸°íšŒì¶”êµ¬": ["ë¶€ì˜ ì¦ëŒ€"],
                "ê³µë™ì²´ ë°œì „": ["ê°€ì¹˜ ì°½ì¶œ"],
                "ì°½ì¡°ì  íŒŒê´´": ["ë¶€ì˜ ì¦ëŒ€"],
                "ë¯¸ë˜ì§€í–¥": ["ê°€ì¹˜ ì°½ì¶œ"]
            }

            attitude_scores = {}
            for comp, score in competence_scores.items():
                for att in comp_to_att[comp]:
                    attitude_scores[att] = attitude_scores.get(att, 0) + score * 0.5

            mission_scores = {}
            for att, score in attitude_scores.items():
                for mission in att_to_mission[att]:
                    mission_scores[mission] = mission_scores.get(mission, 0) + score * 0.5

            outcome_scores = {}
            for mission, score in mission_scores.items():
                for outcome in mission_to_outcome[mission]:
                    outcome_scores[outcome] = outcome_scores.get(outcome, 0) + score * 0.5

            return outcome_scores, attitude_scores, mission_scores

            def compute_bombi_score(competence_scores):
        comp_to_att = {
            "ë„ì „ì •ì‹ ": ["ë„ì „ Â· ê·¹ë³µ", "ì£¼ë„ Â· ì‚¬ì—…í™”"],
            "ìµœê³ Â·ìµœì´ˆÂ·ìµœì‹ Â·ìœ ì¼ ì§€í–¥": ["ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ", "í˜ì‹  Â· ë³€í™” Â· ê°œì„ "],
            "Integrity": ["ì¡°í•© Â· ì¤‘ê°œ", "ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ"],
            "ì°½ì¡°ì  ë¬¸ì œí•´ê²°": ["ì—­ë°œìƒ Â· ì¬í•´ì„", "ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜"],
            "ë…ë¦½ì„± Â· ìê¸°ê³ ìš© Â· ìê¸°ì„¸ê³„": ["ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ", "ë„ì „ Â· ê·¹ë³µ"],
            "ì§„ì·¨ì„±(ì„ ë„ì„±)": ["ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜", "ì£¼ë„ Â· ì‚¬ì—…í™”"],
            "ìœ„í—˜ê°ìˆ˜ì„±": ["ì¡°í•© Â· ì¤‘ê°œ", "í˜ì‹  Â· ë³€í™” Â· ê°œì„ "],
            "í˜ì‹ ì„±": ["ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ", "ì—­ë°œìƒ Â· ì¬í•´ì„"]
        }

        att_to_mission = {
            "ì°½ì¡° Â· ë°œëª… Â· ê°œë°œ": ["ë¯¸ë˜ì§€í–¥"],
            "ì¡°í•© Â· ì¤‘ê°œ": ["ê¸°íšŒì¶”êµ¬"],
            "í˜ì‹  Â· ë³€í™” Â· ê°œì„ ": ["ì°½ì¡°ì  íŒŒê´´"],
            "ë„ì „ Â· ê·¹ë³µ": ["ê¸°íšŒì¶”êµ¬"],
            "ì£¼ë„ Â· ì‚¬ì—…í™”": ["ê¸°íšŒì¶”êµ¬"],
            "ì—­ë°œìƒ Â· ì¬í•´ì„": ["ì°½ì¡°ì  íŒŒê´´"],
            "ê°œì²™ Â· íƒí—˜ Â· ëª¨í—˜": ["ë¯¸ë˜ì§€í–¥"],
            "ë°œê²¬ Â· ë°œìƒ Â· ìƒìƒ": ["ê³µë™ì²´ ë°œì „"]
        }

        mission_to_outcome = {
            "ê¸°íšŒì¶”êµ¬": ["ë¶€ì˜ ì¦ëŒ€"],
            "ê³µë™ì²´ ë°œì „": ["ê°€ì¹˜ ì°½ì¶œ"],
            "ì°½ì¡°ì  íŒŒê´´": ["ë¶€ì˜ ì¦ëŒ€"],
            "ë¯¸ë˜ì§€í–¥": ["ê°€ì¹˜ ì°½ì¶œ"]
        }

        attitude_scores = {}
        for comp, score in competence_scores.items():
            for att in comp_to_att[comp]:
                attitude_scores[att] = attitude_scores.get(att, 0) + score * 0.5

        mission_scores = {}
        for att, score in attitude_scores.items():
            for mission in att_to_mission[att]:
                mission_scores[mission] = mission_scores.get(mission, 0) + score * 0.5

        outcome_scores = {}
        for mission, score in mission_scores.items():
            for outcome in mission_to_outcome[mission]:
                outcome_scores[outcome] = outcome_scores.get(outcome, 0) + score * 0.5

        return outcome_scores, attitude_scores, mission_scores

    if competence_scores:
        st.subheader("ğŸ•¸ï¸ Competence Layer (Radar Chart)")
        fig = go.Figure()
        fig.add_trace(go.Scatterpolar(
            r=list(competence_scores.values()),
            theta=list(competence_scores.keys()),
            fill='toself',
            name='ë´„ë¹„ ì ìˆ˜'
        ))
        fig.update_layout(
            polar=dict(
                radialaxis=dict(visible=True, range=[0, 1]),
                angularaxis=dict(direction='clockwise')
            ),
            showlegend=False
        )
        st.plotly_chart(fig, use_container_width=True)

        with st.expander("ğŸ“Š í•˜ìœ„ ìš”ì†Œë³„ ì ìˆ˜ ë³´ê¸°"):
            for bundle, values in traits:
                st.markdown(f"**{bundle}**")
                for i, score in enumerate(values):
                    label = trait_names.get(bundle, [])[i] if i < len(trait_names.get(bundle, [])) else f"í•˜ìœ„ ìš”ì†Œ {i+1}"
                    st.markdown(f"â€ƒâ€ƒ- {label}: {score:.2f}")

        st.markdown("
ğŸŒŸ **Outcome Layer**")
        outcome, attitude, mission = compute_bombi_score(competence_scores)

        st.markdown("
ğŸŒŸ **Outcome Layer**")
        for k, v in outcome.items():
            st.markdown(f"- {k}: {v:.2f}")

        st.markdown("
ğŸ¯ **Mission Layer**")
        for k, v in mission.items():
            st.markdown(f"- {k}: {v:.2f}")

        st.markdown("
ğŸŒ€ **Attitude Layer**")
        for k, v in attitude.items():
            st.markdown(f"- {k}: {v:.2f}")
